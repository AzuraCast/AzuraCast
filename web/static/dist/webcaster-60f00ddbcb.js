"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Webcaster=function(s){var a={};function i(t){if(a[t])return a[t].exports;var e=a[t]={i:t,l:!1,exports:{}};return s[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}return i.m=s,i.c=a,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==_typeof(e)&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(s,a,function(t){return e[t]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/static/dist",i(i.s=0)}([function(t,e,s){s.r(e);function a(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mixer card"},[s("div",{staticClass:"card-header bg-primary-dark"},[s("h5",{staticClass:"card-title"},[e._v("\n            "+e._s(e.$t("headers.mixer"))+"\n        ")])]),e._v(" "),s("div",{staticClass:"card-body"},[s("div",{staticClass:"d-flex flex-row"},[s("div",{staticClass:"flex-shrink-0 pt-1 pr-2"},[e._v("1")]),e._v(" "),s("div",{staticClass:"flex-fill"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.position,expression:"position"}],staticClass:"custom-range slider",attrs:{type:"range",min:"0",max:"1",step:"0.01"},domProps:{value:e.position},on:{__r:function(t){e.position=t.target.value}}})]),e._v(" "),s("div",{staticClass:"flex-shrink-0 pt-1 pl-2"},[e._v("2")])])])])}function i(t,e,s,a,i,n,o,r){var c=_typeof((t=t||{}).default);"object"!==c&&"function"!==c||(t=t.default);var l,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=s,u._compiled=!0),a&&(u.functional=!0),n&&(u._scopeId=n),o?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},u._ssrRegister=l):i&&(l=r?function(){i.call(this,this.$root.$options.shadowRoot)}:i),l)if(u.functional){u._injectStyles=l;var d=u.render;u.render=function(t,e){return l.call(e),d(t,e)}}else{var v=u.beforeCreate;u.beforeCreate=v?[].concat(v,l):[l]}return{exports:t,options:u}}a._withStripped=!0;var n=i({data:function(){return{position:.5}},watch:{position:function(t,e){this.$root.$emit("new-mixer-value",t)}}},a,[],!1,null,null,null);n.options.__file="vue/webcaster/mixer.vue";function o(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"card"},[e("div",{staticClass:"card-header bg-primary-dark"},[e("h5",{staticClass:"card-title"},[s._v("\n            "+s._s(s.$t("headers.microphone"))+"\n\n            "),e("div",{staticClass:"float-right"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:s.volume,expression:"volume",modifiers:{number:!0}}],staticClass:"custom-range",attrs:{type:"range",min:"0",max:"150",value:"100"},domProps:{value:s.volume},on:{__r:function(t){s.volume=s._n(t.target.value)},blur:function(t){return s.$forceUpdate()}}})])])]),s._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"control-group d-flex justify-content-center mb-3"},[e("div",{staticClass:"btn-group btn-group-sm"},[e("button",{staticClass:"btn btn-danger",class:{active:s.playing},on:{click:s.toggleRecording}},[e("i",{staticClass:"material-icons"},[s._v("mic")])]),s._v(" "),e("button",{staticClass:"btn",class:{"btn-primary":s.passThrough},on:{click:s.cue}},[s._v(s._s(s.$t("buttons.cue")))])])]),s._v(" "),s.playing?e("div",[e("div",{staticClass:"progress mb-1"},[e("div",{staticClass:"progress-bar",style:{width:s.volumeLeft+"%"}})]),s._v(" "),e("div",{staticClass:"progress mb-2"},[e("div",{staticClass:"progress-bar",style:{width:s.volumeRight+"%"}})])]):s._e(),s._v(" "),e("div",{staticClass:"form-group microphone-entry"},[e("label",{staticClass:"mb-2",attrs:{for:"select_microphone_source"}},[s._v(s._s(s.$t("settings.micSource")))]),s._v(" "),e("div",{staticClass:"controls"},[e("select",{directives:[{name:"model",rawName:"v-model",value:s.device,expression:"device"}],staticClass:"form-control",attrs:{id:"select_microphone_source"},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});s.device=t.target.multiple?e:e[0]}}},s._l(s.devices,function(t){return e("option",{domProps:{value:t.deviceId}},[s._v(s._s(t.label))])}),0)])])])])}var r=n.exports,c={inject:["getStream","resumeStream"],data:function(){return{controlsNode:null,trackGain:0,trackGainObj:null,destination:null,sink:null,passThrough:!1,passThroughObj:null,source:null,playing:!1,paused:!1,position:0,volume:100,volumeLeft:0,volumeRight:0}},mounted:function(){this.sink=this.getStream().webcast},watch:{volume:function(t,e){this.setTrackGain(t)}},methods:{createControlsNode:function(){var v,p,m,t,h=this;return v=parseFloat(4096)/parseFloat(this.getStream().context.sampleRate),p=Math.log(parseFloat(4096)),m=2*Math.log(10),(t=this.getStream().context.createScriptProcessor(4096,2,2)).onaudioprocess=function(t){var e,s,a,i,n,o,r,c,l,u,d;for(null!=(null!=(o=h.source)?o.position:void 0)?h.position=h.source.position():null!=h.source&&(h.position=parseFloat(h.position)+v),l=[],e=i=0,r=t.inputBuffer.numberOfChannels-1;0<=r?i<=r:r<=i;e=0<=r?++i:--i){for(a=n=u=0,c=(s=t.inputBuffer.getChannelData(e)).length-1;0<=c?n<=c:c<=n;a=0<=c?++n:--n)u+=Math.pow(s[a],2);d=100*Math.exp((Math.log(u)-p)/m),0===e?h.volumeLeft=d:h.volumeRight=d,l.push(t.outputBuffer.getChannelData(e).set(s))}return l},t},createPassThrough:function(){var t,o=this;return(t=this.getStream().context.createScriptProcessor(256,2,2)).onaudioprocess=function(t){var e,s,a,i,n;for(s=t.inputBuffer.getChannelData(e),n=[],e=a=0,i=t.inputBuffer.numberOfChannels-1;0<=i?a<=i:i<=a;e=0<=i?++a:--a)o.passThrough?n.push(t.outputBuffer.getChannelData(e).set(s)):n.push(t.outputBuffer.getChannelData(e).set(new Float32Array(s.length)));return n},t},setTrackGain:function(t){return this.trackGainObj.gain.value=parseFloat(t)/100},togglePause:function(){var t,e;null!=(null!=(t=this.source)?t.pause:void 0)&&((null!=(e=this.source)&&"function"==typeof e.paused?e.paused():void 0)?(this.source.play(),this.playing=!0,this.paused=!1):(this.source.pause(),this.playing=!1,this.paused=!0))},prepare:function(){return this.controlsNode=this.createControlsNode(),this.controlsNode.connect(this.sink),this.trackGainObj=this.getStream().context.createGain(),this.trackGainObj.connect(this.controlsNode),this.trackGainObj.gain.value=1,this.destination=this.trackGainObj,this.passThroughObj=this.createPassThrough(),this.passThroughObj.connect(this.getStream().context.destination),this.trackGainObj.connect(this.passThroughObj)},stop:function(){var t,e,s,a,i;null!=(t=this.source)&&"function"==typeof t.stop&&t.stop(),null!=(e=this.source)&&e.disconnect(),null!=(s=this.trackGainObj)&&s.disconnect(),null!=(a=this.controlsNode)&&a.disconnect(),null!=(i=this.passThroughObj)&&i.disconnect(),this.source=this.trackGainObj=this.controlsNode=this.passThroughObj=null,this.position=0,this.volumeLeft=0,this.volumeRight=0,this.playing=!1,this.paused=!1},seek:function(t){var e,s;(e=null!=(s=this.source)&&"function"==typeof s.seek?s.seek(t):void 0)&&(this.position=e)},prettifyTime:function(t){var e,s,a,i;return e=parseInt(t/3600),t%=3600,(s=parseInt(t/60))<10&&(s="0".concat(s)),(i=parseInt(t%60))<10&&(i="0".concat(i)),a="".concat(s,":").concat(i),0<e&&(a="".concat(e,":").concat(a)),a},sendMetadata:function(t){this.getStream().webcast.sendMetadata(t.metadata)}}},l={extends:c,data:function(){return{device:null,devices:[],isRecording:!1}},watch:{device:function(t,e){if(null!=this.source)return this.createSource()}},mounted:function(){var t,e;navigator.mediaDevices||(navigator.mediaDevices={}),(t=navigator.mediaDevices).getUserMedia||(t.getUserMedia=function(s){var a;return null==(a=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)?Promise.reject(new Error("getUserMedia is not implemented in this browser")):new Promise(function(t,e){return a.call(navigator,s,t,e)})}),(e=navigator.mediaDevices).enumerateDevices||(e.enumerateDevices=function(){return Promise.reject(new Error("enumerateDevices is not implemented on this browser"))});var s=this;navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(){return navigator.mediaDevices.enumerateDevices().then(s.setDevices)}),this.$root.$on("new-cue",this.onNewCue)},methods:{cue:function(){this.resumeStream(),this.$root.$emit("new-cue",this.passThrough?"off":"microphone")},onNewCue:function(t){this.passThrough="microphone"===t},toggleRecording:function(){this.resumeStream(),this.playing?this.stop():this.play()},createSource:function(e){var t,s=this;return null!=this.source&&this.source.disconnect(this.destination),t={video:!1},this.device?t.audio={deviceId:this.device}:t.audio=!0,this.getStream().createMicrophoneSource(t,function(t){return s.source=t,s.source.connect(s.destination),"function"==typeof e?e():void 0})},play:function(){var t=this;return this.prepare(),this.createSource(function(){t.playing=!0,t.paused=!1})},setDevices:function(t){t=_.filter(t,function(t){var e=t.kind;t.deviceId;return"audioinput"===e}),_.isEmpty(t)||(this.devices=t,this.device=_.first(t).deviceId)}}};o._withStripped=!0;var u=i(l,o,[],!1,null,null,null);u.options.__file="vue/webcaster/microphone.vue";function d(){var n=this,t=n.$createElement,s=n._self._c||t;return s("div",{staticClass:"card"},[s("div",{staticClass:"card-header bg-primary-dark"},[s("h5",{staticClass:"card-title"},[n._v("\n            "+n._s(n.$t("headers."+n.id))+"\n\n            "),s("div",{staticClass:"float-right"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:n.volume,expression:"volume",modifiers:{number:!0}}],staticClass:"custom-range",attrs:{type:"range",min:"0",max:"150",value:"100"},domProps:{value:n.volume},on:{__r:function(t){n.volume=n._n(t.target.value)},blur:function(t){return n.$forceUpdate()}}})])])]),n._v(" "),s("div",{staticClass:"card-body"},[s("div",{staticClass:"control-group d-flex justify-content-center"},[s("div",{staticClass:"btn-group btn-group-sm"},[!n.playing||n.paused?s("button",{staticClass:"btn btn-sm btn-success",on:{click:n.play}},[s("i",{staticClass:"material-icons"},[n._v("play_arrow")])]):n._e(),n._v(" "),n.playing&&!n.paused?s("button",{staticClass:"btn btn-sm btn-warning",on:{click:function(t){return n.togglePause()}}},[s("i",{staticClass:"material-icons"},[n._v("pause")])]):n._e(),n._v(" "),s("button",{staticClass:"btn btn-sm",on:{click:function(t){return n.previous()}}},[s("i",{staticClass:"material-icons"},[n._v("fast_rewind")])]),n._v(" "),s("button",{staticClass:"btn btn-sm",on:{click:function(t){return n.next()}}},[s("i",{staticClass:"material-icons"},[n._v("fast_forward")])]),n._v(" "),s("button",{staticClass:"btn btn-sm btn-danger",on:{click:function(t){return n.stop()}}},[s("i",{staticClass:"material-icons"},[n._v("stop")])]),n._v(" "),s("button",{staticClass:"btn btn-sm",class:{"btn-primary":n.passThrough},on:{click:function(t){return n.cue()}}},[n._v(n._s(n.$t("buttons.cue")))])])]),n._v(" "),n.playing?s("div",{staticClass:"mt-3"},[s("div",{staticClass:"d-flex flex-row mb-2"},[s("div",{staticClass:"flex-shrink-0 pt-1 pr-2"},[n._v(n._s(n._f("prettifyTime")(n.position)))]),n._v(" "),s("div",{staticClass:"flex-fill"},[s("input",{staticClass:"custom-range slider",attrs:{type:"range",min:"0",max:"100",step:"0.1"},domProps:{value:n.seekingPosition},on:{mousedown:function(t){n.isSeeking=!0},mousemove:function(t){return n.doSeek(t)},mouseup:function(t){n.isSeeking=!1}}})]),n._v(" "),s("div",{staticClass:"flex-shrink-0 pt-1 pl-2"},[n._v(n._s(n._f("prettifyTime")(n.duration)))])]),n._v(" "),s("div",{staticClass:"progress mb-1"},[s("div",{staticClass:"progress-bar",style:{width:n.volumeLeft+"%"}})]),n._v(" "),s("div",{staticClass:"progress"},[s("div",{staticClass:"progress-bar",style:{width:n.volumeRight+"%"}})])]):n._e(),n._v(" "),s("div",{staticClass:"form-group mt-2"},[s("div",{staticClass:"custom-file"},[s("input",{staticClass:"custom-file-input files",attrs:{id:n.id+"_files",type:"file",accept:"audio/*",multiple:"multiple"},on:{change:function(t){return n.addNewFiles(t.target.files)}}}),n._v(" "),s("label",{staticClass:"custom-file-label",attrs:{for:n.id+"_files"}},[n._v(n._s(n.$t("misc.addFiles")))])])]),n._v(" "),s("div",{staticClass:"form-group mb-0"},[s("div",{staticClass:"custom-control custom-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:n.playThrough,expression:"playThrough"}],staticClass:"custom-control-input",attrs:{id:n.id+"_playthrough",type:"checkbox"},domProps:{checked:Array.isArray(n.playThrough)?-1<n._i(n.playThrough,null):n.playThrough},on:{change:function(t){var e=n.playThrough,s=t.target,a=!!s.checked;if(Array.isArray(e)){var i=n._i(e,null);s.checked?i<0&&(n.playThrough=e.concat([null])):-1<i&&(n.playThrough=e.slice(0,i).concat(e.slice(i+1)))}else n.playThrough=a}}}),n._v(" "),s("label",{staticClass:"custom-control-label",attrs:{for:n.id+"_playthrough"}},[n._v(n._s(n.$t("settings.playThrough")))])]),n._v(" "),s("div",{staticClass:"custom-control custom-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:n.loop,expression:"loop"}],staticClass:"custom-control-input",attrs:{id:n.id+"_loop",type:"checkbox"},domProps:{checked:Array.isArray(n.loop)?-1<n._i(n.loop,null):n.loop},on:{change:function(t){var e=n.loop,s=t.target,a=!!s.checked;if(Array.isArray(e)){var i=n._i(e,null);s.checked?i<0&&(n.loop=e.concat([null])):-1<i&&(n.loop=e.slice(0,i).concat(e.slice(i+1)))}else n.loop=a}}}),n._v(" "),s("label",{staticClass:"custom-control-label",attrs:{for:n.id+"_loop"}},[n._v(n._s(n.$t("settings.loop")))])])])]),n._v(" "),0<n.files.length?s("div",{staticClass:"list-group list-group-flush"},n._l(n.files,function(t,e){return s("a",{staticClass:"list-group-item list-group-item-action flex-column align-items-start",class:{active:e==n.fileIndex},attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),n.play({fileIndex:e})}}},[s("div",{staticClass:"d-flex w-100 justify-content-between"},[s("h5",{staticClass:"mb-0"},[n._v(n._s(t.metadata.title?t.metadata.title:n.$t("misc.unknownTitle")))]),n._v(" "),s("small",{staticClass:"pt-1"},[n._v(n._s(n._f("prettifyTime")(t.audio.length)))])]),n._v(" "),s("p",{staticClass:"mb-0"},[n._v(n._s(t.metadata.artist?t.metadata.artist:n.$t("misc.unknownArtist")))])])}),0):n._e()])}var v=u.exports,p={extends:c,data:function(){return{fileIndex:-1,files:[],volume:100,duration:0,playThrough:!0,loop:!1,isSeeking:!1,seekPosition:0,mixGainObj:null}},computed:{positionPercent:function(){return 100*this.position/parseFloat(this.duration)},seekingPosition:function(){return this.isSeeking?this.seekPosition:this.positionPercent}},props:{id:String},mounted:function(){this.mixGainObj=this.getStream().context.createGain(),this.mixGainObj.connect(this.getStream().webcast),this.sink=this.mixGainObj,this.$root.$on("new-mixer-value",this.setMixGain),this.$root.$on("new-cue",this.onNewCue)},filters:{prettifyTime:function(t){if(void 0===t)return"N/A";var e=parseInt(t/3600);t%=3600;var s=parseInt(t/60),a=parseInt(t%60);return s<10&&(s="0"+s),a<10&&(a="0"+a),0<e?e+":"+s+":"+a:s+":"+a}},methods:{cue:function(){this.resumeStream(),this.$root.$emit("new-cue",this.passThrough?"off":this.id)},onNewCue:function(t){this.passThrough=t===this.id},setMixGain:function(t){"playlist_1"===this.id?this.mixGainObj.gain.value=1-t:this.mixGainObj.gain.value=t},addNewFiles:function(t){var s=this;_.each(t,function(e){e.readTaglibMetadata(function(t){s.files.push({file:e,audio:t.audio,metadata:t.metadata})})})},play:function(t){var s=this;if(this.resumeStream(),this.paused)this.togglePause();else if(this.stop(),this.file=this.selectFile(t))return this.prepare(),this.getStream().createFileSource(this.file,this,function(t){var e;s.source=t,s.source.connect(s.destination),null!=s.source.duration?s.duration=s.source.duration():null!=(null!=(e=s.file.audio)?e.length:void 0)&&(s.duration=parseFloat(s.file.audio.length)),s.source.play(s.file),s.$root.$emit("metadata-update",{title:s.file.metadata.title||"N/A",artist:s.file.metadata.artist||"N/A"}),s.playing=!0,s.paused=!1})},selectFile:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(0!==this.files.length){if(t.fileIndex)this.fileIndex=t.fileIndex;else if(this.fileIndex+=t.backward?-1:1,this.fileIndex<0&&(this.fileIndex=this.files.length-1),this.fileIndex>=this.files.length){if(t.isAutoPlay&&!this.loop)return void(this.fileIndex=-1);this.fileIndex<0?this.fileIndex=this.files.length-1:this.fileIndex=0}return this.files[this.fileIndex]}},previous:function(){if(this.playing)return this.play({backward:!0})},next:function(){if(this.playing)return this.play()},onEnd:function(){if(this.stop(),this.playThrough)return this.play({isAutoPlay:!0})},doSeek:function(t){this.isSeeking&&(this.seekPosition=t.target.value,this.seek(this.seekPosition/100))}}};d._withStripped=!0;var m=i(p,d,[],!1,null,null,null);m.options.__file="vue/webcaster/playlist.vue";function h(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"card settings"},[e("div",{staticClass:"card-header bg-primary-dark"},[e("h5",{staticClass:"card-title"},[n._v(n._s(n.stationName))])]),n._v(" "),e("div",{staticClass:"card-body pt-0"},[e("div",{staticClass:"row pb-4"},[e("div",{staticClass:"col-sm-12"},[e("ul",{staticClass:"nav nav-tabs card-header-tabs mt-0"},[e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link active",attrs:{href:"#settings","data-toggle":"tab"}},[n._v(n._s(n.$t("headers.settings")))])]),n._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{href:"#metadata","data-toggle":"tab"}},[n._v(n._s(n.$t("headers.metadata")))])])])])]),n._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-12"},[e("div",{staticClass:"tab-content mt-1"},[e("div",{staticClass:"tab-pane active",attrs:{id:"settings"}},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"mb-2"},[n._v(n._s(n.$t("settings.encoder")))]),n._v(" "),e("div",{staticClass:"controls"},[e("div",{staticClass:"custom-control custom-radio custom-control-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:n.encoder,expression:"encoder"}],staticClass:"custom-control-input",attrs:{id:"encoder_mp3",type:"radio",value:"mp3"},domProps:{checked:n._q(n.encoder,"mp3")},on:{change:function(t){n.encoder="mp3"}}}),n._v(" "),e("label",{staticClass:"custom-control-label",attrs:{for:"encoder_mp3"}},[n._v(n._s(n.$t("settings.encoder_mp3")))])]),n._v(" "),e("div",{staticClass:"custom-control custom-radio custom-control-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:n.encoder,expression:"encoder"}],staticClass:"custom-control-input",attrs:{id:"encoder_raw",type:"radio",value:"raw"},domProps:{checked:n._q(n.encoder,"raw")},on:{change:function(t){n.encoder="raw"}}}),n._v(" "),e("label",{staticClass:"custom-control-label",attrs:{for:"encoder_raw"}},[n._v(n._s(n.$t("settings.encoder_raw")))])])])]),n._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"mb-2",attrs:{for:"select_samplerate"}},[n._v(n._s(n.$t("settings.samplerate")))]),n._v(" "),e("div",{staticClass:"controls"},[e("select",{directives:[{name:"model",rawName:"v-model.number",value:n.samplerate,expression:"samplerate",modifiers:{number:!0}}],staticClass:"form-control",attrs:{id:"select_samplerate"},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return n._n(e)});n.samplerate=t.target.multiple?e:e[0]}}},[e("option",{attrs:{value:"8000"}},[n._v("8 kHz")]),n._v(" "),e("option",{attrs:{value:"11025"}},[n._v("11.025 kHz")]),n._v(" "),e("option",{attrs:{value:"12000"}},[n._v("12 kHz")]),n._v(" "),e("option",{attrs:{value:"16000"}},[n._v("16 kHz")]),n._v(" "),e("option",{attrs:{value:"22050"}},[n._v("22.05 kHz")]),n._v(" "),e("option",{attrs:{value:"24000"}},[n._v("24 kHz")]),n._v(" "),e("option",{attrs:{value:"32000"}},[n._v("32 kHz")]),n._v(" "),e("option",{attrs:{value:"44100"}},[n._v("44.1 kHz")]),n._v(" "),e("option",{attrs:{value:"48000"}},[n._v("48 kHz")])])])]),n._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"mb-2",attrs:{for:"select_bitrate"}},[n._v(n._s(n.$t("settings.bitrate")))]),n._v(" "),e("div",{staticClass:"controls"},[e("select",{directives:[{name:"model",rawName:"v-model.number",value:n.bitrate,expression:"bitrate",modifiers:{number:!0}}],staticClass:"form-control",attrs:{id:"select_bitrate"},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return n._n(e)});n.bitrate=t.target.multiple?e:e[0]}}},[e("option",{attrs:{value:"8"}},[n._v("8 kbps")]),n._v(" "),e("option",{attrs:{value:"16"}},[n._v("16 kbps")]),n._v(" "),e("option",{attrs:{value:"24"}},[n._v("24 kbps")]),n._v(" "),e("option",{attrs:{value:"32"}},[n._v("32 kbps")]),n._v(" "),e("option",{attrs:{value:"40"}},[n._v("40 kbps")]),n._v(" "),e("option",{attrs:{value:"48"}},[n._v("48 kbps")]),n._v(" "),e("option",{attrs:{value:"56"}},[n._v("56 kbps")]),n._v(" "),e("option",{attrs:{value:"64"}},[n._v("64 kbps")]),n._v(" "),e("option",{attrs:{value:"80"}},[n._v("80 kbps")]),n._v(" "),e("option",{attrs:{value:"96"}},[n._v("96 kbps")]),n._v(" "),e("option",{attrs:{value:"112"}},[n._v("112 kbps")]),n._v(" "),e("option",{attrs:{value:"128"}},[n._v("128 kbps")]),n._v(" "),e("option",{attrs:{value:"144"}},[n._v("144 kbps")]),n._v(" "),e("option",{attrs:{value:"160"}},[n._v("160 kbps")]),n._v(" "),e("option",{attrs:{value:"192"}},[n._v("192 kbps")]),n._v(" "),e("option",{attrs:{value:"224"}},[n._v("224 kbps")]),n._v(" "),e("option",{attrs:{value:"256"}},[n._v("256 kbps")]),n._v(" "),e("option",{attrs:{value:"320"}},[n._v("320 kbps")])])])]),n._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"mb-2"},[n._v(n._s(n.$t("settings.djCredentials")))]),n._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6"},[e("input",{directives:[{name:"model",rawName:"v-model",value:n.djUsername,expression:"djUsername"}],staticClass:"form-control",attrs:{type:"text",placeholder:n.$t("settings.djUsername")},domProps:{value:n.djUsername},on:{input:function(t){t.target.composing||(n.djUsername=t.target.value)}}})]),n._v(" "),e("div",{staticClass:"col-6"},[e("input",{directives:[{name:"model",rawName:"v-model",value:n.djPassword,expression:"djPassword"}],staticClass:"form-control",attrs:{type:"password",placeholder:n.$t("settings.djPassword")},domProps:{value:n.djPassword},on:{input:function(t){t.target.composing||(n.djPassword=t.target.value)}}})])])]),n._v(" "),e("div",{staticClass:"form-group mb-0"},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:n.asynchronous,expression:"asynchronous"}],staticClass:"custom-control-input",attrs:{id:"use_async_worker",type:"checkbox"},domProps:{checked:Array.isArray(n.asynchronous)?-1<n._i(n.asynchronous,null):n.asynchronous},on:{change:function(t){var e=n.asynchronous,s=t.target,a=!!s.checked;if(Array.isArray(e)){var i=n._i(e,null);s.checked?i<0&&(n.asynchronous=e.concat([null])):-1<i&&(n.asynchronous=e.slice(0,i).concat(e.slice(i+1)))}else n.asynchronous=a}}}),n._v(" "),e("label",{staticClass:"custom-control-label",attrs:{for:"use_async_worker"}},[n._v(n._s(n.$t("settings.asynchronous")))])])])]),n._v(" "),e("div",{staticClass:"tab-pane",attrs:{id:"metadata"}},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"mb-2",attrs:{for:"metadata_title"}},[n._v(n._s(n.$t("settings.metadataTitle")))]),n._v(" "),e("div",{staticClass:"controls"},[e("input",{directives:[{name:"model",rawName:"v-model",value:n.metadata.title,expression:"metadata.title"}],staticClass:"form-control",attrs:{id:"metadata_title",type:"text",disabled:!n.isStreaming},domProps:{value:n.metadata.title},on:{input:function(t){t.target.composing||n.$set(n.metadata,"title",t.target.value)}}})])]),n._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"mb-2",attrs:{for:"metadata_artist"}},[n._v(n._s(n.$t("settings.metadataArtist")))]),n._v(" "),e("div",{staticClass:"controls"},[e("input",{directives:[{name:"model",rawName:"v-model",value:n.metadata.artist,expression:"metadata.artist"}],staticClass:"form-control",attrs:{id:"metadata_artist",type:"text",disabled:!n.isStreaming},domProps:{value:n.metadata.artist},on:{input:function(t){t.target.composing||n.$set(n.metadata,"artist",t.target.value)}}})])]),n._v(" "),e("div",{staticClass:"form-group"},[e("button",{staticClass:"btn btn-primary",attrs:{disabled:!n.isStreaming},on:{click:n.updateMetadata}},[n._v(n._s(n.$t("buttons.updateMetadata")))])])])])])])]),n._v(" "),e("div",{staticClass:"card-actions"},[n.isStreaming?n._e():e("button",{staticClass:"btn btn-success",on:{click:n.startStreaming}},[n._v(n._s(n.$t("buttons.startStreaming")))]),n._v(" "),n.isStreaming?e("button",{staticClass:"btn btn-danger",on:{click:n.stopStreaming}},[n._v(n._s(n.$t("buttons.stopStreaming")))]):n._e(),n._v(" "),e("button",{staticClass:"btn",class:{"btn-primary":n.passThrough},on:{click:n.cue}},[n._v(n._s(n.$t("buttons.cue")))])])])}var f=m.exports,g={inject:["getStream","resumeStream"],data:function(){return{isStreaming:!1,djUsername:"",djPassword:"",bitrate:128,samplerate:44100,encoder:"mp3",asynchronous:!0,passThrough:!1,metadata:{title:"",artist:""}}},computed:{uri:function(){return"wss://"+this.djUsername+":"+this.djPassword+"@"+this.baseUri}},props:{stationName:String,baseUri:String},mounted:function(){this.$root.$on("new-cue",this.onNewCue),this.$root.$on("metadata-update",this.onMetadataUpdate)},methods:{cue:function(){this.resumeStream(),this.$root.$emit("new-cue",this.passThrough?"off":"master")},onNewCue:function(t){this.passThrough="master"===t,this.getStream().webcast.setPassThrough(this.passThrough)},startStreaming:function(){var t;switch(this.resumeStream(),this.encoder){case"mp3":t=Webcast.Encoder.Mp3;break;case"raw":t=Webcast.Encoder.Raw}var e=new t({channels:2,samplerate:this.samplerate,bitrate:this.bitrate});this.samplerate!==this.getStream().context.sampleRate&&(e=new Webcast.Encoder.Resample({encoder:e,type:Samplerate.LINEAR,samplerate:this.getStream().context.sampleRate})),this.asynchronous&&(e=new Webcast.Encoder.Asynchronous({encoder:e,scripts:["https://cdn.rawgit.com/webcast/libsamplerate.js/master/dist/libsamplerate.js","https://cdn.rawgit.com/savonet/shine/master/js/dist/libshine.js","https://cdn.rawgit.com/webcast/webcast.js/master/lib/webcast.js"]})),this.getStream().webcast.connectSocket(e,this.uri),this.isStreaming=!0},stopStreaming:function(){this.getStream().webcast.close(),this.isStreaming=!1},updateMetadata:function(){this.$root.$emit("metadata-update",{title:this.metadata.title,artist:this.metadata.artist}),notify("Metadata updated!","success",!0)},onMetadataUpdate:function(t){return this.metadata.title=t.title,this.metadata.artist=t.artist,this.getStream().webcast.sendMetadata(t)}}};h._withStripped=!0;var b=i(g,h,[],!1,null,null,null);b.options.__file="vue/webcaster/settings.vue";function C(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-4 mb-sm-4"},[e("settings",{attrs:{"station-name":this.stationName,"base-uri":this.baseUri}})],1),this._v(" "),e("div",{staticClass:"col-md-8"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-8 mb-sm-4"},[e("microphone")],1),this._v(" "),e("div",{staticClass:"col-md-4 mb-sm-4"},[e("mixer")],1)]),this._v(" "),e("div",{staticClass:"row mb-4"},[e("div",{staticClass:"col-md-6 mb-sm-4"},[e("playlist",{attrs:{id:"playlist_1"}})],1),this._v(" "),e("div",{staticClass:"col-md-6"},[e("playlist",{attrs:{id:"playlist_2"}})],1)])])])}var y=b.exports,w={init:function(){this.context||("undefined"!=typeof webkitAudioContext?this.context=new webkitAudioContext:this.context=new AudioContext,this.webcast=this.context.createWebcastSource(4096,2),this.webcast.connect(this.context.destination))},resumeContext:function(){"running"!==this.context.state&&this.context.resume()},createAudioSource:function(t,e,s){var a,i,n=t.file,o=t.audio;return(a=new Audio(URL.createObjectURL(n))).controls=!1,a.autoplay=!1,a.loop=!1,a.addEventListener("ended",function(){return e.onEnd()}),i=null,a.addEventListener("canplay",function(){if(null==i)return(i=w.context.createMediaElementSource(a)).play=function(){return a.play()},i.position=function(){return a.currentTime},i.duration=function(){return a.duration},i.paused=function(){return a.paused},i.stop=function(){return a.pause(),a.remove()},i.pause=function(){return a.pause()},i.seek=function(t){var e;return e=t*parseFloat(o.length),a.currentTime=e},s(i)})},createFileSource:function(t,e,s){var a;return null!=(a=this.source)&&a.disconnect(),this.createAudioSource(t,e,s)},createMicrophoneSource:function(t,s){return navigator.mediaDevices.getUserMedia(t).then(function(e){var t;return(t=w.context.createMediaStreamSource(e)).stop=function(){var t;return null!=(t=e.getAudioTracks())?t[0].stop():void 0},s(t)})},close:function(t){return this.webcast.close(t)}},k=w,x={data:function(){return{stream:k}},components:{mixer:r,microphone:v,playlist:f,settings:y},props:{stationName:String,baseUri:String},provide:function(){return{getStream:this.getStream,resumeStream:this.resumeStream}},methods:{getStream:function(){return this.stream.init(),this.stream},resumeStream:function(){this.stream.resumeContext()}}};C._withStripped=!0;var S=i(x,C,[],!1,null,null,null);S.options.__file="vue/webcaster.vue",e.default=S.exports}]);